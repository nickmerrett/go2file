# go2rtc Surveillance Preset Configuration
# Optimized for 24/7 security recording with segmented files

# Define your cameras here
streams:
  front_door: rtsp://admin:password@192.168.1.100/stream1
  back_door: rtsp://admin:password@192.168.1.101/stream1
  garage: rtsp://admin:password@192.168.1.102/stream1
  living_room: rtsp://admin:password@192.168.1.103/stream1

# Surveillance-optimized recording configuration
recording:
  # Storage Configuration
  base_path: "/var/recordings"                    # Main recording directory
  path_template: "{year}/{month}/{day}/{stream}" # Organized by date and camera
  filename_template: "{stream}_{date}_{time}"     # Clear naming with date/time
  default_format: "mkv"                           # Better for continuous recording
  create_directories: true                        # Auto-create folder structure

  # Segmentation Settings (Key for Surveillance)
  enable_segments: true                           # Enable segmentation by default
  segment_duration: "30m"                         # 30-minute segments (good balance)
  max_file_size: 1024                            # 1GB max per segment (safety limit)

  # Quality Settings (Optimized for Storage vs Quality)
  default_video: "copy"                          # Copy codecs by default (no CPU load)
  default_audio: "copy"                          # Copy audio codecs
  bitrate_limit: ""                              # No bitrate limit (preserve original)

  # Retention Policy (Surveillance Focused)
  retention_days: 30                             # Keep recordings for 30 days
  max_recordings: 0                              # No limit on number of recordings
  max_total_size: 512000                         # 500GB total storage limit

  # Automatic Cleanup (Important for Long-term Operation)
  enable_cleanup: true                           # Enable automatic cleanup
  cleanup_interval: "1h"                        # Check for cleanup every hour
  move_to_archive: false                         # Delete old files (change to true for archiving)
  archive_path: "/var/recordings/archive"        # Archive location if enabled

  # Surveillance Behavior
  auto_start: true                               # Auto-start recording for all cameras
  restart_on_error: true                         # Auto-restart on FFmpeg failures
  buffer_time: "5s"                             # 5-second pre-recording buffer
  post_recording_time: "10s"                     # Continue 10s after stream ends

  # Monitoring
  enable_metrics: true                           # Enable recording metrics
  metrics_interval: "5m"                        # Collect metrics every 5 minutes

  # Per-Camera Overrides (Examples)
  streams:
    # High-priority outdoor cameras - continuous + scheduled backups
    front_door:
      enabled: true
      auto_start: true                           # 24/7 continuous recording
      video: "copy"
      audio: "copy"
      format: "mkv"
      retention_days: 60                         # Keep front door footage longer
      segment_duration: "60m"                    # 1-hour segments for main entrance
      path_template: "security/front_door/{year}/{month}/{day}"
      filename_template: "front_door_{date}_{time}"
      schedule: "0 0 * * *"                      # Additional daily backup at midnight (1 hour)
      
    back_door:
      enabled: true
      auto_start: true
      video: "copy"
      audio: "copy"
      retention_days: 60                         # Keep back door footage longer
      segment_duration: "60m"
      path_template: "security/back_door/{year}/{month}/{day}"
      filename_template: "back_door_{date}_{time}"

    # Standard cameras - default settings work well
    garage:
      enabled: true
      auto_start: true
      video: "copy"
      audio: "copy"
      # Uses global defaults (30-day retention, 30-min segments)

    # Indoor camera - scheduled recording only for privacy
    living_room:
      enabled: true
      auto_start: false                          # No continuous recording for privacy
      video: "copy"
      audio: "copy"
      retention_days: 7                          # Shorter retention for indoor
      segment_duration: "15m"                    # Smaller segments
      path_template: "indoor/{year}/{month}/{day}"
      schedule: "0 9-17 * * 1-5"                 # Only during work hours on weekdays

    # Motion-activated camera - scheduled recording during specific times
    garage:
      enabled: true
      auto_start: false                          # No continuous recording
      video: "copy"
      audio: "copy" 
      schedule: "*/30 18-23 * * *"               # Every 30 minutes from 6 PM to 11 PM

    # Disabled camera example
    # old_camera:
    #   enabled: false                           # Completely disable recording

# Network Configuration
api:
  listen: ":1984"

rtsp:
  listen: ":8554"

webrtc:
  listen: ":8555"

# Logging Configuration (Recommended for Surveillance)
log:
  level: "info"                                  # Good balance of info without spam
  format: "json"                                 # Structured logging for analysis
  output: "stdout"                               # Can redirect to file if needed